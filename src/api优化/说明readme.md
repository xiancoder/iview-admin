项目::接口控制
=================

留言:: liuyp 2020年3月25日13:59:12

***

> 负责::所有的接口有关的内容在这里记录
> 注意::页面增删改查逻辑相关接口均有本模块负责
> 注意::登陆用户(管理员)相关系统相关的接口由状态来负责调用 (只是负责调用 其ajax代码还是写在这里的)
> 注意::根据 模块/开发迭代/业务名称 划分不同的文件/文件夹

```
├── api // 接口管理
    ├── cache.js // 缓存包装的axios实例
    ├── api.student.js // 学生类
    └── index.js //axios配置/出口
```

> 每个类基本包括 改 删 查 枚
> 改 指 新建和编辑 由id=0来决定是否新建 新建包含批量导入一项
> 删 根据id删除
> 查 查全部 查单一
> 枚 全部信息作为下拉列表 固定枚举













- 想法:: 第一 开发者开发阶段单独准备接口
    - 不管是先开发页面还是先开发接口 接口/调用 是分开的
    - 目的是把接口作为前后端数据不一致性的解决方案
        - 后端存数据库所用的类型与前端控件方便使用的类型不一致
        - 比如前端常用的true/false对应后台存库就是1/0
        - 比如前端用两个字段(是否开启概率/概率值)表达功能对应后台存库就是有值和0
        - 比如前端先开发对应后台数据库的字段不一致
    - ...(待完善)
- 想法:: 第二 商议并统一不一致性解决方案
    - 比如本模块负责讲true/false转成1/0
    - 比如本模块负责讲两个字段整成一个
    - 比如本模块负责讲重写字段名
    - ...(待完善)
- 要求:: 传参必须是后台想要的格式 返回结果必须处理再提供给业务逻辑
- 优点
    - 类似功能统一放置 减少错误几率 提高效率
    - 方便自动化生产代码 也方便单元测试 因为有规律可循
    - 开发接口模块的人甚至可以不用关心它对应什么逻辑
- 想法:: 第三 开发业务逻辑时方便调用 随用随取 挂载vue原型
    - 不用担心接口出错 404500等错误由route模块负责报错终止
    - 不用担心接口出错 后台接口处理不正确有本模块负责报错赋默认值
    - 使用者只管成功后做什么 失败后做什么 不理会异常甚至是弹框
- 想法:: 第四 单元测试 这个需要真实后台来配合 不能mock
    - 时不时批量测试一下接口是否通
    - 最好使用增查改删顺心依次测试某个维度 不给服务器数据库太多无用内容

```
// *********************************************
// ajax分离结构
// 放弃三层结构 因为不实用 被打脸了
// 2019年7月17日09:44:04 liuyp
// 放弃action和ajax结合方式 不实用 不方便
// 2019年7月26日15:03:15 liuyp
// ======================================
// 第一部分 只获取需要的字段(前端想要的格式)
// 第二部分 对一些参数进行默认值处理(接口想要的格式)
// 第三部分 对一些参数转换字段名(接口想要的名字)
// 第四部分 ajax传参以及返回值处理 注意401 500错误已经被处理
// *********************************************
// 名字代表一切
// list 获取(符合条件) 理解顺序 list(获取) employee(员工) [根据条件]
// pull 拉取(下拉框特定) 理解顺序 pull(拉取) employee(员工) status(状态) [根据条件]
// edit 编辑(指定) 理解顺序 edit(编辑) employee(员工) status(状态) [根据条件]
// *********************************************
// 状态管理依旧 将ajax部分独立处理
// get 请求用的最多 复用率比较大
// post 基本上没有复用的
// 固定数据有很多 且不建议使用promise方式
// *********************************************
```
